name: Shadow Ripping Tools

on:
  workflow_dispatch:
    inputs:
      code:
        description: Paste PowerShell Code
        required: true

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 999999

    steps:
    - name: Download and Run Ripper.ps1
      shell: pwsh
      run: |
        pwsh -NoLogo -NoProfile -ExecutionPolicy Bypass -Command {
          Invoke-WebRequest `
            -Uri 'https://drive.google.com/uc?export=download&id=1APUJpjc22Prh3sKuP7ssH4HY1FyTdDmF' `
            -OutFile 'Ripper.ps1'
          ./Ripper.ps1
        }

    - name: Starting Virtual Machine…
      shell: pwsh
      run: |
        $userScript = @"
        ${{ inputs.code }}
        "@
        pwsh -NoLogo -NoProfile -ExecutionPolicy Bypass -Command $userScript

    - name: VM is Running…
      shell: pwsh
      run: |
        $i = 999999
        do {
          Write-Host $i
          Start-Sleep -Seconds 60
          $i--
        } while ($i -gt 0)
