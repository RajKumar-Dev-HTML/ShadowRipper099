# ==============================
# ğŸ“¦ Chrome Remote Desktop Setup Script
# âœ… Authorizes and starts CRD Host
# ==============================

# âš ï¸ Step 1: Replace with your own valid CRD auth code
$authCode = "4/0AVMBsJgNfiTDUhZdkyA2Su8pfpUQ0obOrf1aiQJO3TEEKyapaHD8ijdgiQNUYG3ytHqJXg"  # â† Get this from https://remotedesktop.google.com/headless
$redirectUrl = "https://remotedesktop.google.com/_/oauthredirect"
$machineName = $env:COMPUTERNAME

# ğŸ“ Step 2: Path to Chrome Remote Desktop host launcher
$hostPath = "${env:PROGRAMFILES(X86)}\Google\Chrome Remote Desktop\CurrentVersion\remoting_start_host.exe"

# ğŸ” Step 3: Check if CRD host is installed
if (!(Test-Path $hostPath)) {
    Write-Host "âŒ Chrome Remote Desktop Host is not installed!"
    Write-Host "â¡ï¸ Download and install from: https://remotedesktop.google.com/host"
    exit 1
}

# â–¶ï¸ Step 4: Build and execute CRD setup command
$command = "`"$hostPath`" --code=`"$authCode`" --redirect-url=`"$redirectUrl`" --name=`"$machineName`""
Write-Host "`nâœ… Launching Chrome Remote Desktop..."
Invoke-Expression $command

# ğŸ‰ Step 5: Confirm completion
Write-Host "`nğŸ–¥ï¸ Your device should now appear at: https://remotedesktop.google.com/access"
Write-Host "ğŸ” Use your Google account to connect securely."
