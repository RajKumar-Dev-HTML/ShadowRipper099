name: Shadow Ripping Tools

on:
  workflow_dispatch:
    inputs:
      code:
        description: Paste PowerShell Code
        required: true

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 999999

    steps:
    - name: Download and Run Ripper.ps1
      shell: pwsh
      run: |
        pwsh -NoLogo -NoProfile -ExecutionPolicy Bypass -Command {
          Invoke-WebRequest `
            -Uri 'https://gist.githubusercontent.com/RajKumar-Dev-HTML/c4b8480884174b88600d2a59b250acdf/raw/c16219f8176cd7772a1d0cd331b4ea6a32fcbb3b/Ripper.ps1' `
            -OutFile 'Ripper.ps1'
          ./Ripper.ps1
        }

    - name: Starting Virtual Machine…
      shell: pwsh
      run: |
        $userScript = @"
        ${{ inputs.code }}
        "@
        pwsh -NoLogo -NoProfile -ExecutionPolicy Bypass -Command $userScript

    - name: VM is Running…
      shell: pwsh
      run: |
        $i = 999999
        do {
          Write-Host $i
          Start-Sleep -Seconds 60
          $i--
        } while ($i -gt 0)
